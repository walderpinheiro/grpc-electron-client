#!/usr/bin/env node
var path=require("path"),fs=require("fs");const filesObj={};function fromDir(e,s){if(!fs.existsSync(e))return void console.log("no dir ",e);const r=fs.readdirSync(e);r.forEach((c,i)=>{const o=path.join(e,r[i]);if(fs.lstatSync(o).isDirectory())fromDir(o,s);else if(o.indexOf(s)>=0){const e=o.replace(/^.*[\\\/]/,""),s=fs.readFileSync(o).toString("base64");filesObj[e.replace(/\.[^\/.]+$/,"")]=s}})}if(fromDir(process.cwd(),".proto"),Object.keys(filesObj).length>0){fs.existsSync(process.cwd()+"/src/grpc")||fs.mkdirSync(process.cwd()+"/src/grpc"),fs.writeFileSync(process.cwd()+"/src/grpc/proto.json",JSON.stringify(filesObj));const e=Object.keys(filesObj).map(e=>({[e.toUpperCase()]:e})).reduce((e,s)=>({...e,...s}),{}),s=`export default Object.freeze(${JSON.stringify(e)})`;fs.writeFileSync(process.cwd()+"/src/grpc/index.js",s)}
